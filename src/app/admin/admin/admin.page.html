<div class="admin-page">
  <!-- Header -->
  <div class="header">
    <div class="header-left">
      <h1>{{ formatProvinceName(selectedProvince) }}</h1>
      <div class="user-info">
        <span class="user-icon">ðŸ‘¤</span>
        <span class="user-email">{{ currentUser?.email }}</span>
      </div>
    </div>
    <div class="header-right">
      <ion-button color="danger" (click)="confirmLogout()">
        <ion-icon slot="start" name="log-out-outline"></ion-icon>
        Logout
      </ion-button>
    </div>
    </div>

  <!-- Files Section -->
  <div class="files-section">
    <div class="files-header">
      <h2>Files</h2>
      <div class="province-selector">
        <select 
          class="province-dropdown"
          [value]="selectedProvince" 
          (change)="onProvinceChange($event)">
          <option *ngFor="let province of provinces" [value]="province.value">
            {{ province.label }}
          </option>
        </select>
      </div>
    </div>

    <!-- Loading State -->
    <div *ngIf="loading" class="loading-container">
      <div class="spinner"></div>
      <p>Loading files...</p>
    </div>

    <!-- Files Table -->
    <div *ngIf="!loading" class="files-table-container">
      <table class="files-table">
        <thead>
          <tr>
            <th class="col-name">Name</th>
            <th class="col-owner">Owner</th>
            <th class="col-date">Date Created</th>
            <th class="col-actions"></th>
          </tr>
        </thead>
        <tbody>
          <tr *ngIf="filteredFiles.length === 0">
            <td colspan="4" class="empty-state">
              <p>No files found</p>
            </td>
          </tr>
          <tr *ngFor="let file of filteredFiles" class="file-row">
            <td class="col-name">
              <span class="file-icon">ðŸ“„</span>
              <span class="file-name">{{ file.fileName }}</span>
            </td>
            <td class="col-owner">
              <span class="owner-icon">ðŸ‘¤</span>
              <span class="owner-email">{{ file['uploadedByEmail'] || file.uploadedBy }}</span>
            </td>
            <td class="col-date">
              <span class="date-icon">ðŸ“…</span>
              <span class="date-text">{{ formatDate(file.uploadedAt) }}</span>
            </td>
            <td class="col-actions">
              <button class="action-btn" (click)="toggleMenu(file.id)">
                â‹®
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- Bottom Sheet Action Menu -->
  <div class="bottom-sheet-overlay" *ngIf="selectedFileId" (click)="closeMenu()"></div>
  <div class="bottom-sheet" *ngIf="selectedFileId" [class.show]="selectedFileId">
    <div class="bottom-sheet-content" (click)="$event.stopPropagation()">
      <div class="menu-header">{{ getSelectedFileName() }}</div>
      <button class="menu-item" (click)="viewFile(getSelectedFile())">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
          <circle cx="12" cy="12" r="3"></circle>
        </svg>
        View
      </button>
      <button class="menu-item" (click)="editFile(getSelectedFile())">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
          <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
        </svg>
        Edit
      </button>
      <button class="menu-item delete" (click)="deleteFile(getSelectedFile())">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <polyline points="3 6 5 6 21 6"></polyline>
          <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
        </svg>
        Delete
      </button>
      <button class="menu-item cancel" (click)="closeMenu()">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
        Cancel
      </button>
    </div>
  </div>
</div>